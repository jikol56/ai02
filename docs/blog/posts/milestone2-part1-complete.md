# VBA Code Blocker 개발 일지 - 마일스톤 2 (1/3) 완료

## 개발 배경
마일스톤 2의 첫 번째 단계에서는 Windows 레지스트리를 통한 VBA 차단 기능을 구현했습니다. 이는 시스템 레벨에서 VBA 실행을 차단하는 핵심 기능입니다.

## 이번 단계에서 달성한 목표

### 1. 레지스트리 관리 시스템 구현
- VBA 관련 레지스트리 키 식별 및 관리
- 레지스트리 설정 백업 및 복원 기능
- 레지스트리 상태 모니터링

### 2. 안전한 레지스트리 조작
- 백업 시스템 구현
- 복원 메커니즘 구현
- 오류 처리 및 로깅

### 3. GUI 개선
- VBA 복원 기능 추가
- 상태 표시 개선
- 사용자 피드백 강화

## 기술적 도전과 해결

### 1. 레지스트리 백업 및 복원
- **도전**: 
  - Windows 레지스트리 형식(.reg) 처리
  - UTF-16 인코딩 처리
  - 레지스트리 키 권한 문제
- **해결**:
  - .reg 파일 파서 구현
  - 적절한 인코딩 처리
  - 예외 처리 강화

### 2. 사용자 인터페이스 개선
- **도전**:
  - 직관적인 UI/UX 설계
  - 실시간 상태 업데이트
  - 사용자 피드백 제공
- **해결**:
  - 상태 표시 개선
  - 확인 대화상자 추가
  - 오류 메시지 개선

## 구현된 기능 상세

### 1. 레지스트리 관리
```python
class RegistryManager:
    def __init__(self):
        self.vba_keys = {
            'HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\16.0\\Excel\\Security': {
                'VBAWarnings': 2,  # 모든 매크로 비활성화
                'AccessVBOM': 0    # VBA 프로젝트 액세스 비활성화
            },
            # ... 다른 Office 프로그램 설정
        }
```

### 2. 백업 및 복원
- 타임스탬프가 포함된 백업 파일 생성
- UTF-16 인코딩으로 .reg 파일 처리
- 자동 복원 기능

### 3. 사용자 인터페이스
- VBA 차단/복원 토글 버튼
- 실시간 상태 표시
- 작업 결과 피드백

## 다음 단계 계획

### 1. 프로세스 모니터링 시스템 강화
- 실시간 VBA 프로세스 감지
- 자동 종료 기능
- 로그 기록 시스템

### 2. 보안 기능 추가
- UAC 권한 처리
- 시스템 변경 사항 추적
- 복구 시스템 구현

## 학습한 점
1. Windows 레지스트리 작업
   - 레지스트리 키 접근
   - 값 수정 및 백업
   - 권한 관리

2. 파일 처리
   - UTF-16 인코딩
   - .reg 파일 형식
   - 파일 시스템 작업

3. 사용자 인터페이스
   - 상태 관리
   - 사용자 피드백
   - 오류 처리

## 참고 자료
- [Windows Registry API](https://docs.microsoft.com/en-us/windows/win32/sysinfo/registry)
- [Python winreg 모듈](https://docs.python.org/3/library/winreg.html)
- [PyQt6 문서](https://www.riverbankcomputing.com/static/Docs/PyQt6/)

## 다음 단계
다음으로는 프로세스 모니터링 시스템을 강화하여 VBA 프로세스의 실시간 감지 및 제어 기능을 구현할 예정입니다. 이를 통해 더 효과적인 VBA 차단이 가능할 것으로 기대됩니다. 