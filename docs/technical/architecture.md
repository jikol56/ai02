# VBA Code Blocker 아키텍처 문서

## 시스템 개요

VBA Code Blocker는 Microsoft Office 애플리케이션의 VBA 실행을 제어하는 Windows 기반 보안 도구입니다. 이 문서는 시스템의 아키텍처와 주요 컴포넌트를 설명합니다.

## 아키텍처 다이어그램

```
+------------------+     +------------------+     +------------------+
|      GUI         |     |    Core          |     |    Security      |
|  (PyQt5)         |<--->|  Components      |<--->|    Manager       |
+------------------+     +------------------+     +------------------+
        ^                        ^                        ^
        |                        |                        |
        v                        v                        v
+------------------+     +------------------+     +------------------+
|    Logger        |     |  Change Tracker  |     |  Registry        |
|  System          |<--->|  System          |<--->|  Manager         |
+------------------+     +------------------+     +------------------+
```

## 주요 컴포넌트

### 1. GUI (src/gui/)
- **MainWindow**: 메인 애플리케이션 창
  - 탭 기반 인터페이스
  - 실시간 상태 업데이트
  - 로그 조회 및 관리
  - 사용자 피드백

### 2. Core Components (src/core/)
- **VBABlocker**: 핵심 기능 관리
  - VBA 차단/복원
  - 시스템 상태 관리
  - 컴포넌트 조정

- **RegistryManager**: 레지스트리 관리
  - 레지스트리 백업/복원
  - VBA 관련 키 수정
  - 상태 확인

- **ChangeTracker**: 시스템 변경 추적
  - 변경 사항 모니터링
  - 이력 관리
  - 상태 추적

- **Logger**: 로깅 시스템
  - 다양한 로그 타입
  - 자동 로테이션
  - 로그 관리

### 3. Security (src/security/)
- **SecurityManager**: 보안 관리
  - 권한 확인
  - 보안 정책 적용
  - 접근 제어

## 데이터 흐름

1. 사용자 액션
   - GUI를 통한 명령 입력
   - 상태 확인 요청
   - 로그 조회

2. Core 처리
   - 명령 검증
   - 보안 확인
   - 작업 실행

3. 시스템 변경
   - 레지스트리 수정
   - 프로세스 제어
   - 상태 업데이트

4. 로깅
   - 작업 기록
   - 변경 사항 저장
   - 오류 로깅

## 보안 고려사항

1. 권한 관리
   - 관리자 권한 확인
   - 최소 권한 원칙
   - 접근 제어

2. 데이터 보호
   - 로그 파일 보안
   - 백업 파일 관리
   - 민감 정보 처리

3. 시스템 보호
   - 안전한 레지스트리 수정
   - 프로세스 제어
   - 변경 사항 추적

## 확장성

1. 모듈식 설계
   - 독립적인 컴포넌트
   - 명확한 인터페이스
   - 쉬운 확장

2. 플러그인 지원
   - 추가 기능 통합
   - 사용자 정의 확장
   - API 제공

## 성능 고려사항

1. 리소스 관리
   - 메모리 사용 최적화
   - CPU 사용량 제어
   - 디스크 I/O 최소화

2. 비동기 처리
   - 백그라운드 작업
   - 이벤트 기반 처리
   - 응답성 유지

## 유지보수

1. 로깅
   - 상세한 로그 기록
   - 문제 추적
   - 디버깅 지원

2. 모니터링
   - 시스템 상태 추적
   - 성능 모니터링
   - 오류 감지

## 향후 개선 사항

1. 보안 강화
   - 추가 보안 기능
   - 취약점 대응
   - 감사 기능

2. 성능 최적화
   - 리소스 사용 개선
   - 응답 시간 단축
   - 효율성 향상

3. 사용자 경험
   - UI/UX 개선
   - 사용성 향상
   - 문서화 강화 