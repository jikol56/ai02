# VBA Code Blocker 아키텍처 문서

## 시스템 개요
VBA Code Blocker는 Windows 환경에서 VBA 코드의 실행을 차단하는 시스템 레벨의 보안 도구입니다. 이 문서는 시스템의 아키텍처와 주요 컴포넌트를 설명합니다.

## 시스템 아키텍처

### 1. 핵심 컴포넌트
```
+------------------+     +------------------+     +------------------+
|     GUI Layer    |     |    Core Layer    |     |   System Layer   |
|  (PyQt6 기반)    |<--->|  (VBA Blocker)   |<--->|  (Windows API)   |
+------------------+     +------------------+     +------------------+
```

#### 1.1 GUI Layer
- **주요 기능**:
  - 사용자 인터페이스 제공
  - VBA 차단 상태 표시
  - 사용자 입력 처리
- **구현 기술**:
  - PyQt6
  - Qt Designer
  - Python

#### 1.2 Core Layer
- **주요 기능**:
  - VBA 프로세스 관리
  - 레지스트리 제어
  - 로깅 시스템
- **구현 기술**:
  - Python
  - psutil
  - win32api

#### 1.3 System Layer
- **주요 기능**:
  - Windows API 접근
  - 시스템 레벨 작업
  - 보안 관리
- **구현 기술**:
  - Windows API
  - Registry API
  - Security API

### 2. 데이터 흐름
```
[User Input] --> [GUI Layer] --> [Core Layer] --> [System Layer]
     ^              |                |                |
     |              v                v                v
[User Output] <-- [Status] <-- [Process Info] <-- [System State]
```

## 보안 아키텍처

### 1. 권한 관리
- **관리자 권한**:
  - 시스템 레벨 변경을 위한 UAC 권한
  - 레지스트리 수정 권한
  - 프로세스 제어 권한

### 2. 데이터 보안
- **로깅**:
  - 암호화된 로그 저장
  - 감사 추적
  - 오류 기록

### 3. 시스템 보호
- **백업 및 복구**:
  - 레지스트리 백업
  - 시스템 상태 저장
  - 복구 메커니즘

## 확장성

### 1. 모듈식 설계
- **장점**:
  - 독립적인 컴포넌트 개발
  - 쉬운 유지보수
  - 기능 확장 용이

### 2. 플러그인 시스템
- **구현 계획**:
  - 커스텀 규칙 추가
  - 새로운 차단 방법 지원
  - 사용자 정의 동작

## 성능 고려사항

### 1. 리소스 사용
- **최적화**:
  - 메모리 사용량 최소화
  - CPU 사용량 최적화
  - 디스크 I/O 최소화

### 2. 응답성
- **개선 방안**:
  - 비동기 작업 처리
  - 백그라운드 모니터링
  - 이벤트 기반 처리

## 향후 계획

### 1. 단기 목표
- 레지스트리 수정 기능 구현
- 프로세스 모니터링 강화
- 보안 기능 추가

### 2. 장기 목표
- 플러그인 시스템 구현
- 성능 최적화
- 추가 보안 기능

## 기술 스택

### 1. 개발 환경
- Python 3.x
- PyQt6
- Windows API

### 2. 주요 라이브러리
- pywin32
- psutil
- python-registry
- logging

## 결론
VBA Code Blocker는 모듈식 설계와 확장 가능한 아키텍처를 통해 효과적인 VBA 코드 차단을 제공합니다. 지속적인 개발과 개선을 통해 더 안정적이고 강력한 보안 도구로 발전할 것입니다. 